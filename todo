# Nostr Hero - Todo List

## High Priority - Architecture Changes

### 1. Save Initialization (Go Migration)
- [ ] Move save initialization from JS to Go backend
- [ ] Gold needs to be changed to an item (not separate field)
- [ ] JS should only collect intro interactions and equipment selection
- [ ] Backend validates and creates proper save structure

### 2. NPC System Refactor
- [ ] NPCs need schedules with location for each time slot
- [ ] Remove NPCs from location files (locations.json)
- [ ] Location data should be in NPC schedule files instead
- [ ] Update location rendering logic to fetch NPCs dynamically

### 3. Vault System Rework
- [ ] Fix vault initialization to use building name instead of city location
- [ ] Clean up vault-related JS code
- [ ] Validate vault structure in backend

## High Priority - JavaScript Cleanup

### Files to Remove/Consolidate
- [ ] Delete `pages/login.js` (confirmed unused)
- [ ] Audit for more unused/duplicate code
- [ ] Document dependencies between files

### Folder Structure Rework
Current issues:
- `pages/game-ui.js` is 1700+ lines (should be split)
- Confusing "pages" vs "systems" organization
- Unclear dependencies and load order

Proposed reorganization:
- [ ] Map out current dependencies
- [ ] Split large files (game-ui.js) into focused modules
- [ ] Clearer separation: core → systems → pages → components
- [ ] Document load order requirements

### Specific Cleanup Tasks
- [ ] Consolidate duplicate code across game-ui.js, game-state.js, game-logic.js
- [ ] Clarify responsibilities of each file
- [ ] Remove dead code within used files

## Medium Priority - Game Systems

### 4. Inventory System Edge Cases
- [ ] Test overflow scenarios
- [ ] Test stacking behavior
- [ ] Test equipment validation
- [ ] Test vault interactions
- [ ] Add backend validation for item operations

### 5. Ground Items (BROKEN)
- [ ] Debug why ground items stopped working
- [ ] Fix ground item rendering
- [ ] Fix ground item pickup logic

### 6. Effects System
- [ ] Finalize effects structure in items
- [ ] Implement effect application logic
- [ ] Test equipment stat bonuses

### 7. Time System Rework
- [ ] Add time controls to districts/locations
- [ ] Implement play/pause/wait button
- [ ] Update NPC schedules to work with time system
- [ ] Test NPC movement based on time

## Notes

### Current JavaScript Structure (24 files)
**Core** (4): session-manager, auth, game-api, nostr-connect
**Pages** (5): game-intro, game-ui, new-game, startup, tabs
**Systems** (9): character-generator, game-state, game-logic, save-system, inventory-interactions, container-system, equipment-selection, profile-manager, relay-manager, theme-manager
**Utils** (3): item-helpers, character-helpers, inventory-helpers
**Components** (2): continue-button, back-button
**Unused** (1): login.js

### Load Order (game.html)
session-manager → game-api → item-helpers → character-helpers → game-ui → auth → character-generator → game-state → game-logic → save-system → container-system → inventory-interactions → startup
