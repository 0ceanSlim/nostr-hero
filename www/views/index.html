{{define "view"}}
<!-- Load required scripts -->
<script src="/scripts/systems/theme-manager.js"></script>
<script src="/scripts/systems/profile-manager.js"></script>
<script src="/scripts/pages/tabs.js"></script>
<script src="/scripts/core/session-manager.js"></script>
<script src="/scripts/core/auth.js"></script>

<!-- Loading Modal -->
<div id="loading-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center" style="background-color: rgba(0, 0, 0, 0.85);">
  <div class="win95-outset pixel-clip p-8 text-center" style="border: 4px solid var(--color-textPrimary);">
    <img src="/res/img/loading.gif" alt="Loading..." class="mx-auto mb-4" style="width: 64px; height: 64px; image-rendering: pixelated;">
    <p id="loading-text" class="text-lg font-bold" style="color: var(--color-textPrimary);">Connecting to extension...</p>
  </div>
</div>

<!-- Simple message system for home page -->
<script>
window.showMessage = function(text, type = 'info', duration = 5000) {
  console.log(`${type.toUpperCase()}: ${text}`);

  // Create simple toast notification
  const toast = document.createElement('div');
  toast.className = 'fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 pixel-clip';
  toast.textContent = text;

  // Style based on type
  if (type === 'success') {
    toast.style.background = 'rgb(34, 197, 94)';
    toast.style.color = 'white';
  } else if (type === 'error') {
    toast.style.background = 'rgb(239, 68, 68)';
    toast.style.color = 'white';
  } else if (type === 'warning') {
    toast.style.background = 'rgb(251, 146, 60)';
    toast.style.color = 'white';
  } else {
    toast.style.background = 'rgb(59, 130, 246)';
    toast.style.color = 'white';
  }

  document.body.appendChild(toast);

  // Fade out and remove
  setTimeout(() => {
    toast.style.transition = 'opacity 0.3s';
    toast.style.opacity = '0';
    setTimeout(() => toast.remove(), 300);
  }, duration);
};

// Show loading modal
window.showLoadingModal = function(text = 'Loading...') {
  const modal = document.getElementById('loading-modal');
  const loadingText = document.getElementById('loading-text');
  if (modal && loadingText) {
    loadingText.textContent = text;
    modal.classList.remove('hidden');
  }
};

// Hide loading modal
window.hideLoadingModal = function() {
  const modal = document.getElementById('loading-modal');
  if (modal) {
    modal.classList.add('hidden');
  }
};

// Listen for authentication events to show/hide loading
if (typeof window !== 'undefined') {
  window.addEventListener('load', () => {
    if (window.sessionManager) {
      window.sessionManager.on('authenticationStarted', (method) => {
        let text = 'Logging in...';
        if (method === 'extension') {
          text = 'Connecting to extension...';
        } else if (method === 'amber') {
          text = 'Connecting to Amber...';
        } else if (method === 'private_key') {
          text = 'Logging in with private key...';
        }
        window.showLoadingModal(text);
      });

      window.sessionManager.on('authenticationSuccess', () => {
        window.hideLoadingModal();
      });

      window.sessionManager.on('authenticationFailed', () => {
        window.hideLoadingModal();
      });
    }
  });
}
</script>

<!-- Tab Navigation -->
<div class="sticky top-0 z-40 win95-outset rounded-md mt-4 mb-4 p-2">
  <div class="tab-scroll-container overflow-x-auto">
    <button id="tab-btn-home" class="tab-inactive pixel-clip">
      ğŸ  Home
    </button>
    <button id="tab-btn-updates" class="tab-inactive pixel-clip">
      ğŸ“° Updates
    </button>
    <button id="tab-btn-roadmap" class="tab-inactive pixel-clip">
      ğŸ—ºï¸ Roadmap
    </button>
    <button id="tab-btn-about" class="tab-inactive pixel-clip">
      ğŸ“š About
    </button>
    <button id="tab-btn-contribute" class="tab-inactive pixel-clip">
      ğŸ¤ Contribute
    </button>
    <button id="tab-btn-wiki" class="tab-inactive pixel-clip">
      ğŸ“– Wiki
    </button>
  </div>
</div>

<!-- Tab Content Container -->
<div class="tab-content-container">
  {{template "tab-home" .}}
  {{template "tab-updates" .}}
  {{template "tab-roadmap" .}}
  {{template "tab-about" .}}
  {{template "tab-contribute" .}}
  {{template "tab-wiki" .}}
</div>
{{end}}
