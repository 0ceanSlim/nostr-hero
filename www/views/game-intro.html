{{define "title"}}Nostr Hero - New Adventure{{end}}

{{define "view"}}
<!-- Google Fonts - Handwritten font for letter -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&display=swap" rel="stylesheet">

<script src="/res/js/session-manager.js"></script>
<script src="/res/js/character-generator.js"></script>
<script src="/res/components/continue-button.js"></script>
<script src="/res/components/back-button.js"></script>
<script src="/res/js/equipment-selection.js"></script>
<script src="/res/js/game-intro.js"></script>

<style>
/* Scene animations */
@keyframes wipeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes wipeOut {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(-20px);
  }
}

/* Equipment selection wipe animations */
@keyframes wipeRight {
  from {
    transform: translateX(0);
    opacity: 1;
  }
  to {
    transform: translateX(100%);
    opacity: 0;
  }
}

@keyframes wipeLeft {
  from {
    transform: translateX(0);
    opacity: 1;
  }
  to {
    transform: translateX(-100%);
    opacity: 0;
  }
}

@keyframes slideInFromLeft {
  from {
    transform: translateX(-100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slideInFromRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.scene-container {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.8s ease-in-out;
}

.scene-container.fade-in {
  opacity: 1;
}

.scene-container.fade-out {
  opacity: 0;
}

.scene-background {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  z-index: 0;
  transition: opacity 0.8s ease-in-out;
}

.scene-text {
  opacity: 0;
  animation: wipeIn 0.8s ease-out forwards;
  animation-delay: 1s;
  position: relative;
  z-index: 1;
  text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.9),
               -1px -1px 4px rgba(0, 0, 0, 0.8);
}

.letter-container {
  position: absolute;
  color: #1a1a1a;
  padding: 1.5rem 2rem;
  overflow-y: auto;
  font-family: 'Caveat', cursive;
  font-weight: 400;
  font-size: 1.5rem;
  line-height: 1;
  text-align: left;
  z-index: 1;
  /* Position to match the black letter area in the background */
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  /* Size to fit within the letter area - narrower for better fit, taller for more text */
  width: 28vw;
  max-width: 380px;
  min-width: 280px;
  height: 50vh;
  max-height: 500px;
  /* Transparent background to show the letter texture beneath */
  background: transparent;
  /* Ensure text is readable */
  text-shadow: 0 0 2px rgba(255, 255, 255, 0.3);
}

/* Pixelated Continue Button */
.pixel-continue-btn {
  background: #fbbf24;
  color: #000;
  padding: 1rem 2rem;
  font-size: 1.25rem;
  font-weight: bold;
  margin-top: 2rem;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  z-index: 1;
  text-shadow: none;

  /* Pixelated border effect */
  box-shadow:
    0 -2px 0 0 #fbbf24,
    0 -4px 0 0 #000,
    2px 0 0 0 #fbbf24,
    4px 0 0 0 #000,
    0 2px 0 0 #fbbf24,
    0 4px 0 0 #000,
    -2px 0 0 0 #fbbf24,
    -4px 0 0 0 #000,

    -2px -2px 0 0 #000,
    2px -2px 0 0 #000,
    2px 2px 0 0 #000,
    -2px 2px 0 0 #000;
}

.pixel-continue-btn:hover {
  background: #fcd34d;
  transform: translateY(-2px);
  box-shadow:
    0 -2px 0 0 #fcd34d,
    0 -4px 0 0 #000,
    2px 0 0 0 #fcd34d,
    4px 0 0 0 #000,
    0 2px 0 0 #fcd34d,
    0 6px 0 0 #000,
    -2px 0 0 0 #fcd34d,
    -4px 0 0 0 #000,

    -2px -2px 0 0 #000,
    2px -2px 0 0 #000,
    2px 2px 0 0 #000,
    -2px 2px 0 0 #000;
}

/* Pixelated Back Button */
.pixel-back-btn {
  background: #6b7280;
  color: #000;
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  position: fixed;
  bottom: 1.5rem;
  left: 1.5rem;
  z-index: 100;
  text-shadow: none;

  /* Pixelated border effect */
  box-shadow:
    0 -2px 0 0 #6b7280,
    0 -3px 0 0 #000,
    2px 0 0 0 #6b7280,
    3px 0 0 0 #000,
    0 2px 0 0 #6b7280,
    0 3px 0 0 #000,
    -2px 0 0 0 #6b7280,
    -3px 0 0 0 #000,

    -2px -2px 0 0 #000,
    2px -2px 0 0 #000,
    2px 2px 0 0 #000,
    -2px 2px 0 0 #000;
}

.pixel-back-btn:hover {
  background: #9ca3af;
  transform: translateY(-1px);
  box-shadow:
    0 -2px 0 0 #9ca3af,
    0 -3px 0 0 #000,
    2px 0 0 0 #9ca3af,
    3px 0 0 0 #000,
    0 2px 0 0 #9ca3af,
    0 4px 0 0 #000,
    -2px 0 0 0 #9ca3af,
    -3px 0 0 0 #000,

    -2px -2px 0 0 #000,
    2px -2px 0 0 #000,
    2px 2px 0 0 #000,
    -2px 2px 0 0 #000;
}

/* Skip Scene Button */
.pixel-skip-btn {
  background: #dc2626;
  color: #fff;
  padding: 0.5rem 1rem;
  font-size: 0.75rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  position: fixed;
  top: 1.5rem;
  right: 1.5rem;
  z-index: 100;
  text-shadow: none;

  /* Pixelated border effect */
  box-shadow:
    0 -2px 0 0 #dc2626,
    0 -3px 0 0 #000,
    2px 0 0 0 #dc2626,
    3px 0 0 0 #000,
    0 2px 0 0 #dc2626,
    0 3px 0 0 #000,
    -2px 0 0 0 #dc2626,
    -3px 0 0 0 #000,

    -2px -2px 0 0 #000,
    2px -2px 0 0 #000,
    2px 2px 0 0 #000,
    -2px 2px 0 0 #000;
}

.pixel-skip-btn:hover {
  background: #ef4444;
  transform: translateY(-1px);
  box-shadow:
    0 -2px 0 0 #ef4444,
    0 -3px 0 0 #000,
    2px 0 0 0 #ef4444,
    3px 0 0 0 #000,
    0 2px 0 0 #ef4444,
    0 4px 0 0 #000,
    -2px 0 0 0 #ef4444,
    -3px 0 0 0 #000,

    -2px -2px 0 0 #000,
    2px -2px 0 0 #000,
    2px 2px 0 0 #000,
    -2px 2px 0 0 #000;
}

/* Item Card Styles */
.item-card {
  border: none;
}

/* Container selection styles (for bundle and simple item containers) */
[data-option-index] {
  transition: all 0.2s ease;
  box-sizing: border-box;
}

[data-option-index]:hover:not(.selected) {
  border-color: #fbbf24 !important;
}

[data-option-index].selected {
  border-color: #10b981 !important;
  border-width: 3px !important;
  box-shadow: 0 0 20px rgba(16, 185, 129, 0.6) !important;
  background-color: rgba(16, 185, 129, 0.05) !important;
  box-sizing: border-box;
}

[data-option-index].selected .info-btn {
  pointer-events: auto !important;
}
</style>

<!-- Full-screen black background -->
<div class="fixed inset-0 bg-black text-white z-50">

  <!-- Initial name input screen -->
  <div id="name-screen" class="flex flex-col items-center justify-center h-full relative z-10">
    <div id="typed-question" class="text-xl md:text-2xl text-center mb-8 px-4">What is your name?</div>
    <div id="name-input-container" class="flex flex-col items-center space-y-4">
      <input
        type="text"
        id="character-name"
        class="bg-gray-800 border-2 border-gray-600 rounded-lg px-6 py-3 text-xl text-center text-white focus:border-green-400 focus:outline-none min-w-72"
        placeholder="Enter your name..."
        maxlength="20"
        onkeydown="if(event.key==='Enter') document.getElementById('continue-btn').click()"
      >
      <button
        id="continue-btn"
        class="bg-green-600 hover:bg-green-700 text-black px-8 py-3 rounded-lg font-bold text-lg transition-colors"
        onclick="startIntroSequence()"
      >
        Begin Your Story
      </button>
    </div>
  </div>

  <!-- Universal Scene Container -->
  <div id="scene-container" class="scene-container hidden">
    <div id="scene-background" class="scene-background"></div>
    <div id="scene-content" class="px-8 text-center max-w-4xl"></div>
  </div>

  <!-- Equipment Selection Screen -->
  <div id="equipment-selection" class="hidden">
    <div class="bg-gray-800 rounded-2xl p-8 max-w-6xl w-full max-h-full overflow-y-auto">
      <h2 class="text-3xl font-bold text-center mb-8 text-yellow-400">Choose Your Equipment</h2>
      <div id="equipment-choices" class="space-y-6"></div>

      <div class="mt-6">
        <h4 class="text-lg font-medium text-gray-300 mb-3">Starting Inventory:</h4>
        <div id="starting-inventory" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2"></div>
      </div>

      <div class="text-center mt-8">
        <button
          id="continue-adventure-btn"
          class="bg-green-600 hover:bg-green-700 text-black px-8 py-4 rounded-lg font-bold text-xl transition-colors"
          onclick="continueAfterEquipment()"
          style="display: none;"
        >
          Continue â†’
        </button>
      </div>
    </div>
  </div>

</div>

<!-- Audio elements -->
<audio id="intro-music">
  <source src="/res/aud/newgame1_medieval-lofi-nokron-the-eternal-city.mp3" type="audio/mpeg">
</audio>

<audio id="game-music">
  <source src="/res/aud/load_medieval-lofi-cycle-of-life.mp3" type="audio/mpeg">
</audio>

{{end}}
