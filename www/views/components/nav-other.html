{{define "nav-other"}}
<div class="relative group">
  <button
    onclick="toggleDropdown('otherDropdown')"
    class="pixel-button pixel-clip rounded px-2 py-2 sm:px-6 sm:py-3 font-bold flex items-center gap-1 sm:gap-2 hover:scale-105 transition-all"
    style="color: var(--color-textPrimary); font-size: 0.65rem; border: 4px solid var(--color-textPrimary);"
  >
    <span class="sm:text-base">âš™ï¸ Other Stuff</span>
    <svg
      class="w-4 h-4"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M19 9l-7 7-7-7"
      />
    </svg>
  </button>

  <!-- Dropdown container -->
  <div
    id="otherDropdown"
    class="absolute right-0 hidden mt-2 win95-outset pixel-clip shadow-lg"
    style="min-width: 14rem; z-index: 50; border: 4px solid var(--color-textPrimary);"
  >
    <ul class="py-2">
      <li>
        <a
          class="block px-4 py-2 whitespace-nowrap transition-colors hover:bg-opacity-20"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          href="/"
          hx-get="/"
          hx-push-url="/"
          hx-swap="outerHTML"
          hx-target="body"
        >
          âš”ï¸ Home
        </a>
      </li>
      <li>
        <a
          href="/discover"
          hx-push-url="/discover"
          class="block px-4 py-2 whitespace-nowrap transition-colors"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          hx-get="/discover"
          hx-swap="outerHTML"
          hx-target="body"
        >
          â›ï¸ Discover
        </a>
      </li>
      <li>
        <a
          href="/alpha-registry"
          hx-push-url="/alpha-registry"
          class="block px-4 py-2 whitespace-nowrap transition-colors"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          hx-get="/alpha-registry"
          hx-swap="outerHTML"
          hx-target="body"
        >
          ğŸ“œ Alpha Registry
        </a>
      </li>
      <li>
        <a
          href="/legacy-registry"
          hx-push-url="/legacy-registry"
          class="block px-4 py-2 whitespace-nowrap transition-colors"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          hx-get="/legacy-registry"
          hx-swap="outerHTML"
          hx-target="body"
        >
          ğŸ—¡ï¸ Legacy Registry
        </a>
      </li>
      <li>
        <a
          href="https://github.com/0ceanSlim/nostr-hero"
          class="block px-4 py-2 whitespace-nowrap transition-colors"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          target="_blank"
        >
          ğŸ’» GitHub
        </a>
      </li>
      <li>
        <a
          href="https://happytavern.co"
          class="block px-4 py-2 whitespace-nowrap transition-colors"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          target="_blank"
        >
          ğŸ» Happy Tavern
        </a>
      </li>
      <li id="logout-item" class="hidden">
        <button
          onclick="handleLogout()"
          class="w-full text-left block px-4 py-2 whitespace-nowrap transition-colors"
          style="color: var(--color-textPrimary);"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
        >
          ğŸšª Logout
        </button>
      </li>
    </ul>
  </div>
</div>

<script>
// Show/hide logout button based on authentication status
function updateAuthUI() {
  const logoutItem = document.getElementById('logout-item');
  if (logoutItem && window.sessionManager && window.sessionManager.isAuthenticated()) {
    logoutItem.classList.remove('hidden');
  } else if (logoutItem) {
    logoutItem.classList.add('hidden');
  }
}

// Handle logout
async function handleLogout() {
  if (window.sessionManager) {
    try {
      await window.sessionManager.logout();
      showMessage('âœ… Logged out successfully', 'success');
      // Reload or redirect after logout
      setTimeout(() => {
        window.location.href = '/';
      }, 500);
    } catch (error) {
      console.error('Logout error:', error);
      showMessage('âŒ Logout failed: ' + error.message, 'error');
    }
  }
}

// Update UI on page load and auth changes
if (typeof window !== 'undefined') {
  // Initial check
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateAuthUI);
  } else {
    updateAuthUI();
  }

  // Listen for auth state changes
  window.addEventListener('auth-changed', updateAuthUI);
}
</script>
{{end}}
